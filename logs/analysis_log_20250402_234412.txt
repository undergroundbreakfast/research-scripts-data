
================================================================================
 ANALYSIS STARTED: 2025-04-02 23:44:12
================================================================================

Connected to Postgres successfully.
Component-level data fetched: shape = (3143, 37)

--------------------------------------------------------------------------------
 EFA SECTION
--------------------------------------------------------------------------------
Potential multicollinearity detected (correlations > 0.8):
  adult_smoking_raw_value and physical_inactivity_raw_value: r = 0.810
This may cause the Moore-Penrose generalized inversion warning.
Bartlett's test: chi_sq=8298.82, p=0.0000 (small p => correlations not identity).
KMO (sampling adequacy) for each variable => [0.72329798 0.64491415 0.75548513 0.77308263 0.65243174]
KMO overall => 0.704

Factor Loadings (Rotated):
  adult_smoking_raw_value: [0.91603023 0.12503628]
  physical_inactivity_raw_value: [0.88565582 0.14388458]
  children_in_poverty_raw_value: [0.81677339 0.37992212]
  unemployment_raw_value: [0.17871933 0.97717392]
  injury_deaths_raw_value: [0.62638845 0.12860533]

Factor Loadings (Rotated):
                               Factor 1  Factor 2
adult_smoking_raw_value           0.916     0.125
physical_inactivity_raw_value     0.886     0.144
children_in_poverty_raw_value     0.817     0.380
unemployment_raw_value            0.179     0.977
injury_deaths_raw_value           0.626     0.129

Strong Factor Loadings (|loading| > 0.4):
  adult_smoking_raw_value: Factor 1: 0.916
  physical_inactivity_raw_value: Factor 1: 0.886
  children_in_poverty_raw_value: Factor 1: 0.817
  unemployment_raw_value: Factor 2: 0.977
  injury_deaths_raw_value: Factor 1: 0.626

Explained Variance (each factor): [0.54298389 0.23041717]
Cumulative Variance by Factor: [0.54298389 0.77340106]

EFA completed. 2 factors extracted.

Factor loadings saved to: results/factor_loadings_20250402_234415.csv
Factor scores saved to: results/factor_scores_20250402_234415.csv

Sample factor scores (head):

         F1        F2
0 -0.140722 -1.103839
1 -0.343733 -0.938441
2  1.867681  0.155748
3  1.349458 -1.170229
4  0.473072 -1.343187

--------------------------------------------------------------------------------
 SEM SECTION
--------------------------------------------------------------------------------
Column 'dv_health_outcome' not found. SEM example won't run properly.

--------------------------------------------------------------------------------
 CONCEPTUAL MODEL SEM
--------------------------------------------------------------------------------

--------------------------------------------------------------------------------
 CONCEPTUAL MODEL SEM ANALYSIS
--------------------------------------------------------------------------------

--------------------------------------------------------------------------------
 EXPLORING AVAILABLE VARIABLES
--------------------------------------------------------------------------------
Total columns in dataset: 39
First 10 columns:
  - county_fips
  - premature_death_raw_value
  - poor_or_fair_health_raw_value
  - poor_physical_health_days_raw_value
  - poor_mental_health_days_raw_value
  - low_birthweight_raw_value
  - adult_smoking_raw_value
  - adult_obesity_raw_value
  - food_environment_index_raw_value
  - physical_inactivity_raw_value

Checking for conceptual model variables:
  ✗ Missing: IV1 (Public Health Policy) (medicaid_expansion_active)
  ✗ Missing: IV2 (Physical Environment) (physical_environment_score)
  ✗ Missing: IV3 (Health Behaviors) (health_behaviors_score)
  ✗ Missing: IV4 (Social & Economic) (social_economic_factors_score)
  ✓ Found: MO1 (GenAI Capabilities) (weighted_ai_adoption_score)
  ✓ Found: MO2 (Robotics Capabilities) (weighted_robotics_adoption_score)
  ✗ Missing: DV1 (Healthcare Accessibility) (clinical_care_score)
  ✗ Missing: DV2 (Healthcare Quality) (health_outcomes_score)
  ✗ Missing: DV3 (Operational Efficiency) (avg_patient_services_margin)
Too many conceptual model variables missing. Cannot build SEM model.

Try checking the following:
1. Does your SQL view contain all required variables?
2. Are column names case-sensitive? (Current code uses lowercase)
3. Check the SQL query in fetch_component_level_data()

--------------------------------------------------------------------------------
 DATA EXPLORATION
--------------------------------------------------------------------------------
Dataset has 3143 rows and 39 columns
Sample column names: ['county_fips', 'premature_death_raw_value', 'poor_or_fair_health_raw_value', 'poor_physical_health_days_raw_value', 'poor_mental_health_days_raw_value']
Creating dv_health_outcome as a composite health measure
Created dv_health_outcome from 2 variables

--------------------------------------------------------------------------------
 SEM EXAMPLE
--------------------------------------------------------------------------------

SEM model specification:

# Measurement part
HealthBeh =~ adult_smoking_raw_value + physical_inactivity_raw_value
SocioEcon =~ children_in_poverty_raw_value + unemployment_raw_value

# Structural part (paths)
dv_health_outcome ~ HealthBeh + SocioEcon


SEM Parameter Estimates:

                             lval  op  ...     z-value   p-value
0         adult_smoking_raw_value   ~  ...           -         -
1   physical_inactivity_raw_value   ~  ...  132.049629       0.0
2   children_in_poverty_raw_value   ~  ...           -         -
3          unemployment_raw_value   ~  ...    4.455634  0.000008
4               dv_health_outcome   ~  ...    0.349022  0.727073
5               dv_health_outcome   ~  ...    0.205885  0.836881
6                       HealthBeh  ~~  ...   35.545816       0.0
7                       HealthBeh  ~~  ...   34.651367       0.0
8                       SocioEcon  ~~  ...    6.469587       0.0
9         adult_smoking_raw_value  ~~  ...   32.799467       0.0
10  children_in_poverty_raw_value  ~~  ...    2.856312  0.004286
11              dv_health_outcome  ~~  ...    1.558469  0.119122
12  physical_inactivity_raw_value  ~~  ...   22.490019       0.0
13         unemployment_raw_value  ~~  ...    39.60534       0.0

[14 rows x 7 columns]
