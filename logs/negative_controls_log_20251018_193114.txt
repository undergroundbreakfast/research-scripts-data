2025-10-18 19:31:14,961 - INFO - Logger initialized.
2025-10-18 19:31:15,032 - INFO - Connected to PostgreSQL 'Research_TEST'.
2025-10-18 19:31:15,032 - INFO - ============================================================
2025-10-18 19:31:15,032 - INFO - DIAGNOSTIC: Checking CHR column data quality
2025-10-18 19:31:15,032 - INFO - ============================================================
2025-10-18 19:31:15,035 - INFO - 
Checking chr_analytic_chunk_2...
2025-10-18 19:31:15,044 - INFO - ================================================================================
2025-10-18 19:31:15,044 - INFO - EXECUTING SQL:
2025-10-18 19:31:15,044 - INFO - --------------------------------------------------------------------------------
2025-10-18 19:31:15,044 - INFO - SELECT 
                long_commute_driving_alone_raw_value,
                COUNT(*) as count,
                COUNT(DISTINCT long_commute_driving_alone_raw_value) as distinct_count
            FROM public.chr_analytic_chunk_2
            WHERE year = '2024'
            GROUP BY long_commute_driving_alone_raw_value
            ORDER BY count DESC
            LIMIT 10
2025-10-18 19:31:15,044 - INFO - ================================================================================
2025-10-18 19:31:15,057 - INFO -   ✓ long_commute_driving_alone_raw_value: Found with 10 distinct values
2025-10-18 19:31:15,057 - INFO -     Top values: ['0.31799998879432678', '0.33700001239776611', '0.30199998617172241', '0.34700000286102295', '0.34400001168251038']
2025-10-18 19:31:15,058 - INFO -     Numeric conversion: 100.0% valid
2025-10-18 19:31:15,058 - INFO -   ❌ school_funding_adequacy_raw_value: NOT FOUND in table
2025-10-18 19:31:15,058 - INFO -   ❌ school_segregation_raw_value: NOT FOUND in table
2025-10-18 19:31:15,059 - INFO - 
Checking chr_analytic_chunk_3...
2025-10-18 19:31:15,062 - INFO -   ❌ long_commute_driving_alone_raw_value: NOT FOUND in table
2025-10-18 19:31:15,062 - INFO - ================================================================================
2025-10-18 19:31:15,062 - INFO - EXECUTING SQL:
2025-10-18 19:31:15,062 - INFO - --------------------------------------------------------------------------------
2025-10-18 19:31:15,062 - INFO - SELECT 
                school_funding_adequacy_raw_value,
                COUNT(*) as count,
                COUNT(DISTINCT school_funding_adequacy_raw_value) as distinct_count
            FROM public.chr_analytic_chunk_3
            WHERE year = '2024'
            GROUP BY school_funding_adequacy_raw_value
            ORDER BY count DESC
            LIMIT 10
2025-10-18 19:31:15,062 - INFO - ================================================================================
2025-10-18 19:31:15,068 - INFO -   ✓ school_funding_adequacy_raw_value: Found with 10 distinct values
2025-10-18 19:31:15,068 - INFO -     Top values: [None, '-4930.80517578125', '-1001.1422729492188', '-1004.7899780273438', '-1008.5399780273438']
2025-10-18 19:31:15,068 - INFO -     Numeric conversion: 90.0% valid
2025-10-18 19:31:15,068 - INFO - ================================================================================
2025-10-18 19:31:15,068 - INFO - EXECUTING SQL:
2025-10-18 19:31:15,068 - INFO - --------------------------------------------------------------------------------
2025-10-18 19:31:15,068 - INFO - SELECT 
                school_segregation_raw_value,
                COUNT(*) as count,
                COUNT(DISTINCT school_segregation_raw_value) as distinct_count
            FROM public.chr_analytic_chunk_3
            WHERE year = '2024'
            GROUP BY school_segregation_raw_value
            ORDER BY count DESC
            LIMIT 10
2025-10-18 19:31:15,068 - INFO - ================================================================================
2025-10-18 19:31:15,072 - INFO -   ✓ school_segregation_raw_value: Found with 10 distinct values
2025-10-18 19:31:15,072 - INFO -     Top values: [None, '0.33536046743392944', '0.24044071137905121', '0.00470366096124053', '0.01063079945743084']
2025-10-18 19:31:15,072 - INFO -     Numeric conversion: 90.0% valid
2025-10-18 19:31:15,072 - INFO - ============================================================
2025-10-18 19:31:15,079 - INFO - ================================================================================
2025-10-18 19:31:15,079 - INFO - EXECUTING SQL:
2025-10-18 19:31:15,079 - INFO - --------------------------------------------------------------------------------
2025-10-18 19:31:15,079 - INFO - SELECT
          vcm.county_fips,
          vcm.population::numeric AS population,
          vcm.census_division,
          vcm.medicaid_expansion_active AS iv1_medicaid_expansion_active,
          vcm.physical_environment_score::numeric AS iv2_physical_environment_score,
          vcm.health_behaviors_score::numeric AS iv3_health_behaviors_score,
          vcm.social_economic_factors_score::numeric AS iv4_social_economic_factors_score,
          vcm.health_outcomes_score::numeric AS dv2_health_outcomes_score,
          vcm.weighted_ai_adoption_score::numeric AS mo1_genai_composite_score,
          vcm.weighted_robotics_adoption_score::numeric AS mo2_robotics_composite_score
    
, vcv.premature_death_raw_value::numeric AS dv21_premature_death_ypll_rate
, vcts.pct_wfaiart_enabled::numeric AS mo11_ai_automate_routine_tasks_pct, vcts.pct_wfaioacw_enabled::numeric AS mo12_ai_optimize_workflows_pct, vcts.pct_wfaippd_enabled::numeric AS mo13_ai_predict_patient_demand_pct, vcts.pct_wfaipsn_enabled::numeric AS mo14_ai_predict_staff_needs_pct, vcts.pct_wfaiss_enabled::numeric AS mo15_ai_staff_scheduling_pct, vcts.pct_robohos_enabled::numeric AS mo21_robotics_in_hospital_pct
, hrsa.irr_county_value::numeric AS sp5_irr_county_value
,
          aha.capex_sum::numeric AS fi1_capex_sum,
          aha.adjpd_sum::numeric AS fi2_adjpd_sum,
          CASE WHEN aha.adjpd_sum IS NOT NULL AND aha.adjpd_sum<>0
               THEN (aha.capex_sum::numeric/aha.adjpd_sum::numeric)
               ELSE NULL END AS fi_capex_intensity_ratio
        
FROM public.vw_conceptual_model_adjpd vcm
LEFT JOIN public.vw_conceptual_model_variables_adjpd  vcv  ON vcm.county_fips=vcv.county_fips
LEFT JOIN public.vw_county_tech_summary_adjpd vcts ON vcm.county_fips=vcts.county_fips

        LEFT JOIN (
          SELECT LPAD(TRIM(CAST(county_fips_code AS TEXT)),5,'0') AS county_fips,
                 AVG(NULLIF(irr_county_value,'')::numeric) AS irr_county_value
          FROM public.hrsa_health_equity_data
          GROUP BY 1
        ) hrsa ON vcm.county_fips=hrsa.county_fips
        

        LEFT JOIN (
          SELECT LPAD(TRIM(CAST(fcounty AS TEXT)),5,'0') AS county_fips,
                 SUM(NULLIF(ceamt,'')::numeric) AS capex_sum,
                 SUM(NULLIF(adjpd,'')::numeric) AS adjpd_sum
          FROM public.aha_survey_data
          GROUP BY 1
        ) aha ON vcm.county_fips=aha.county_fips
        
WHERE vcm.population IS NOT NULL AND vcm.population::numeric>0;
2025-10-18 19:31:15,079 - INFO - ================================================================================
2025-10-18 19:31:44,328 - INFO - Base data: 3135 counties.
2025-10-18 19:31:44,332 - INFO - Added division FE (dummies=8).
2025-10-18 19:31:44,334 - INFO - ================================================================================
2025-10-18 19:31:44,334 - INFO - EXECUTING SQL:
2025-10-18 19:31:44,334 - INFO - --------------------------------------------------------------------------------
2025-10-18 19:31:44,334 - INFO - SELECT 
        LPAD(TRIM(CAST(_5_digit_fips AS TEXT)), 5, '0') as county_fips,
        CAST(year AS TEXT) as year,
        NULLIF(TRIM(population_raw_value), '') AS population_raw_value, NULLIF(TRIM(census_participation_raw_value), '') AS census_participation_raw_value, NULLIF(TRIM(reading_scores_raw_value), '') AS reading_scores_raw_value, NULLIF(TRIM(severe_housing_cost_burden_raw_value), '') AS severe_housing_cost_burden_raw_value, NULLIF(TRIM(_65_and_older_raw_value), '') AS _65_and_older_raw_value, NULLIF(TRIM(not_proficient_in_english_raw_value), '') AS not_proficient_in_english_raw_value, NULLIF(TRIM(school_funding_adequacy_raw_value), '') AS school_funding_adequacy_raw_value, NULLIF(TRIM(school_segregation_raw_value), '') AS school_segregation_raw_value, NULLIF(TRIM(below_18_years_of_age_raw_value), '') AS below_18_years_of_age_raw_value, NULLIF(TRIM(homeownership_raw_value), '') AS homeownership_raw_value, NULLIF(TRIM(voter_turnout_raw_value), '') AS voter_turnout_raw_value, NULLIF(TRIM(hispanic_raw_value), '') AS hispanic_raw_value, NULLIF(TRIM(female_raw_value), '') AS female_raw_value, NULLIF(TRIM(gender_pay_gap_raw_value), '') AS gender_pay_gap_raw_value, NULLIF(TRIM(non_hispanic_white_raw_value), '') AS non_hispanic_white_raw_value, NULLIF(TRIM(juvenile_arrests_raw_value), '') AS juvenile_arrests_raw_value, NULLIF(TRIM(traffic_volume_raw_value), '') AS traffic_volume_raw_value, NULLIF(TRIM(math_scores_raw_value), '') AS math_scores_raw_value, NULLIF(TRIM(non_hispanic_black_raw_value), '') AS non_hispanic_black_raw_value
    FROM public.chr_analytic_chunk_3
    WHERE year IS NOT NULL
2025-10-18 19:31:44,334 - INFO - ================================================================================
2025-10-18 19:31:44,347 - INFO - chr_analytic_chunk_3: Filtered 52 invalid county_fips records
2025-10-18 19:31:44,376 - INFO - chr_analytic_chunk_3: Years range from 2024 to 2024 (3143 valid records, years: [2024])
2025-10-18 19:31:44,377 - INFO - chr_analytic_chunk_3: 19/19 requested columns have data: ['population_raw_value', 'census_participation_raw_value', 'reading_scores_raw_value', 'severe_housing_cost_burden_raw_value', '_65_and_older_raw_value']...
2025-10-18 19:31:44,377 - INFO - chr_analytic_chunk_3: Sample county_fips after processing: ['13265', '20017', '29103', '13283', '38075']
2025-10-18 19:31:44,379 - INFO - ================================================================================
2025-10-18 19:31:44,379 - INFO - EXECUTING SQL:
2025-10-18 19:31:44,379 - INFO - --------------------------------------------------------------------------------
2025-10-18 19:31:44,379 - INFO - SELECT 
        LPAD(TRIM(CAST(_5_digit_fips AS TEXT)), 5, '0') as county_fips,
        CAST(year AS TEXT) as year,
        NULLIF(TRIM(percentage_of_households_with_overcrowding), '') AS percentage_of_households_with_overcrowding, NULLIF(TRIM(long_commute_driving_alone_raw_value), '') AS long_commute_driving_alone_raw_value, NULLIF(TRIM(life_expectancy_raw_value), '') AS life_expectancy_raw_value, NULLIF(TRIM(driving_alone_to_work_raw_value), '') AS driving_alone_to_work_raw_value, NULLIF(TRIM(percentage_of_households_with_high_housing_costs), '') AS percentage_of_households_with_high_housing_costs, NULLIF(TRIM(severe_housing_problems_raw_value), '') AS severe_housing_problems_raw_value, NULLIF(TRIM(air_pollution_particulate_matter_raw_value), '') AS air_pollution_particulate_matter_raw_value, NULLIF(TRIM(pct_households_with_lack_of_kitchen_or_plumbing), '') AS pct_households_with_lack_of_kitchen_or_plumbing, NULLIF(TRIM(drinking_water_violations_raw_value), '') AS drinking_water_violations_raw_value
    FROM public.chr_analytic_chunk_2
    WHERE year IS NOT NULL
2025-10-18 19:31:44,379 - INFO - ================================================================================
2025-10-18 19:31:44,387 - INFO - chr_analytic_chunk_2: Filtered 52 invalid county_fips records
2025-10-18 19:31:44,402 - INFO - chr_analytic_chunk_2: Years range from 2024 to 2024 (3143 valid records, years: [2024])
2025-10-18 19:31:44,402 - INFO - chr_analytic_chunk_2: 9/9 requested columns have data: ['percentage_of_households_with_overcrowding', 'long_commute_driving_alone_raw_value', 'life_expectancy_raw_value', 'driving_alone_to_work_raw_value', 'percentage_of_households_with_high_housing_costs']...
2025-10-18 19:31:44,402 - INFO - chr_analytic_chunk_2: Sample county_fips after processing: ['13265', '30109', '32011', '31015', '17069']
2025-10-18 19:31:44,404 - INFO - ================================================================================
2025-10-18 19:31:44,404 - INFO - EXECUTING SQL:
2025-10-18 19:31:44,404 - INFO - --------------------------------------------------------------------------------
2025-10-18 19:31:44,404 - INFO - SELECT 
        LPAD(TRIM(CAST(_5_digit_fips AS TEXT)), 5, '0') as county_fips,
        CAST(year AS TEXT) as year,
        NULLIF(TRIM(premature_death_raw_value), '') AS premature_death_raw_value
    FROM public.chr_analytic_chunk_1
    WHERE year IS NOT NULL
2025-10-18 19:31:44,404 - INFO - ================================================================================
2025-10-18 19:31:44,408 - INFO - chr_analytic_chunk_1: Filtered 52 invalid county_fips records
2025-10-18 19:31:44,411 - INFO - chr_analytic_chunk_1: Years range from 2024 to 2024 (3143 valid records, years: [2024])
2025-10-18 19:31:44,411 - INFO - chr_analytic_chunk_1: 1/1 requested columns have data: ['premature_death_raw_value']
2025-10-18 19:31:44,411 - INFO - chr_analytic_chunk_1: Sample county_fips after processing: ['46119', '36041', '48045', '17155', '38011']
2025-10-18 19:31:44,416 - INFO - ================================================================================
2025-10-18 19:31:44,416 - INFO - EXECUTING SQL:
2025-10-18 19:31:44,416 - INFO - --------------------------------------------------------------------------------
2025-10-18 19:31:44,416 - INFO - SELECT 1 FROM information_schema.tables
        WHERE table_schema='public' AND table_name=:t LIMIT 1
2025-10-18 19:31:44,416 - INFO - --------------------------------------------------------------------------------
2025-10-18 19:31:44,416 - INFO - PARAMETERS: {'t': 'chr_analytic_chunk_1'}
2025-10-18 19:31:44,416 - INFO - ================================================================================
2025-10-18 19:31:44,417 - INFO - ================================================================================
2025-10-18 19:31:44,417 - INFO - EXECUTING SQL:
2025-10-18 19:31:44,417 - INFO - --------------------------------------------------------------------------------
2025-10-18 19:31:44,417 - INFO - SELECT column_name FROM information_schema.columns
        WHERE table_schema='public' AND table_name=:t
2025-10-18 19:31:44,417 - INFO - --------------------------------------------------------------------------------
2025-10-18 19:31:44,417 - INFO - PARAMETERS: {'t': 'chr_analytic_chunk_1'}
2025-10-18 19:31:44,417 - INFO - ================================================================================
2025-10-18 19:31:44,418 - INFO - ================================================================================
2025-10-18 19:31:44,418 - INFO - EXECUTING SQL:
2025-10-18 19:31:44,418 - INFO - --------------------------------------------------------------------------------
2025-10-18 19:31:44,418 - INFO - SELECT _5_digit_fips, year, premature_death_flag_0_no_flag_1_unreliable_2_suppressed FROM public.chr_analytic_chunk_1;
2025-10-18 19:31:44,418 - INFO - ================================================================================
2025-10-18 19:31:44,425 - INFO - Data summary:
2025-10-18 19:31:44,425 - INFO -   Base counties: 3135
2025-10-18 19:31:44,425 - INFO -   CHR chunk_3: 3143 counties (latest year)
2025-10-18 19:31:44,425 - INFO -   CHR chunk_2: 3143 counties (latest year)
2025-10-18 19:31:44,425 - INFO -   CHR chunk_1 temporal: 2886 county-year records
2025-10-18 19:31:44,425 - INFO -   Year range in chunk_1: 2024-2024
2025-10-18 19:31:44,425 - INFO -   Historical years (2010-2022) available: 0
2025-10-18 19:31:44,425 - WARNING -   ⚠️  No historical CHR data available - temporal falsification will be skipped
2025-10-18 19:31:44,425 - WARNING -   ⚠️  To run temporal falsification, load CHR data from 2010-2022
2025-10-18 19:31:44,425 - INFO - CHR chunk_3: 3143 counties
2025-10-18 19:31:44,425 - INFO - CHR chunk_3 sample county_fips: ['01001', '01003', '01005', '01007', '01009']
2025-10-18 19:31:44,425 - INFO - CHR chunk_3 county_fips dtype: object
2025-10-18 19:31:44,425 - INFO - CHR chunk_2: 3143 counties
2025-10-18 19:31:44,425 - INFO - CHR chunk_2 sample county_fips: ['01001', '01003', '01005', '01007', '01009']
2025-10-18 19:31:44,425 - INFO - CHR chunk_2 county_fips dtype: object
2025-10-18 19:31:44,425 - INFO - Base df: 3135 counties
2025-10-18 19:31:44,425 - INFO - Base df sample county_fips: ['01001', '01003', '01005', '01007', '01009']
2025-10-18 19:31:44,425 - INFO - Base df county_fips dtype: object
2025-10-18 19:31:44,426 - INFO - County overlap between base and chunk_3: 3135 counties
2025-10-18 19:31:44,428 - INFO - [Direct NCO] Processing _65_and_older_raw_value: 3135/3135 valid values (100.0%).
2025-10-18 19:31:44,429 - INFO - [Direct NCO] _65_and_older_raw_value with MO1+MO2: 3135 counties after dropna
2025-10-18 19:31:44,451 - INFO - [Direct NCO] Processing air_pollution_particulate_matter_raw_value: 3107/3135 valid values (99.1%).
2025-10-18 19:31:44,452 - INFO - [Direct NCO] air_pollution_particulate_matter_raw_value with MO1+MO2: 3107 counties after dropna
2025-10-18 19:31:44,471 - INFO - [Direct NCO] Processing below_18_years_of_age_raw_value: 3135/3135 valid values (100.0%).
2025-10-18 19:31:44,472 - INFO - [Direct NCO] below_18_years_of_age_raw_value with MO1+MO2: 3135 counties after dropna
2025-10-18 19:31:44,491 - INFO - [Direct NCO] Processing census_participation_raw_value: 3132/3135 valid values (99.9%).
2025-10-18 19:31:44,492 - INFO - [Direct NCO] census_participation_raw_value with MO1+MO2: 3132 counties after dropna
2025-10-18 19:31:44,512 - INFO - [Direct NCO] Processing drinking_water_violations_raw_value: 3083/3135 valid values (98.3%).
2025-10-18 19:31:44,513 - INFO - [Direct NCO] drinking_water_violations_raw_value with MO1+MO2: 3083 counties after dropna
2025-10-18 19:31:44,533 - INFO - [Direct NCO] Processing driving_alone_to_work_raw_value: 3135/3135 valid values (100.0%).
2025-10-18 19:31:44,534 - INFO - [Direct NCO] driving_alone_to_work_raw_value with MO1+MO2: 3135 counties after dropna
2025-10-18 19:31:44,554 - INFO - [Direct NCO] Processing female_raw_value: 3135/3135 valid values (100.0%).
2025-10-18 19:31:44,555 - INFO - [Direct NCO] female_raw_value with MO1+MO2: 3135 counties after dropna
2025-10-18 19:31:44,574 - INFO - [Direct NCO] Processing gender_pay_gap_raw_value: 3129/3135 valid values (99.8%).
2025-10-18 19:31:44,575 - INFO - [Direct NCO] gender_pay_gap_raw_value with MO1+MO2: 3129 counties after dropna
2025-10-18 19:31:44,594 - INFO - [Direct NCO] Processing hispanic_raw_value: 3135/3135 valid values (100.0%).
2025-10-18 19:31:44,595 - INFO - [Direct NCO] hispanic_raw_value with MO1+MO2: 3135 counties after dropna
2025-10-18 19:31:44,615 - INFO - [Direct NCO] Processing homeownership_raw_value: 3134/3135 valid values (100.0%).
2025-10-18 19:31:44,616 - INFO - [Direct NCO] homeownership_raw_value with MO1+MO2: 3134 counties after dropna
2025-10-18 19:31:44,637 - INFO - [Direct NCO] Processing juvenile_arrests_raw_value: 1919/3135 valid values (61.2%).
2025-10-18 19:31:44,638 - INFO - [Direct NCO] juvenile_arrests_raw_value with MO1+MO2: 1919 counties after dropna
2025-10-18 19:31:44,653 - INFO - [Direct NCO] Processing long_commute_driving_alone_raw_value: 3135/3135 valid values (100.0%).
2025-10-18 19:31:44,654 - INFO - [Direct NCO] long_commute_driving_alone_raw_value with MO1+MO2: 3135 counties after dropna
2025-10-18 19:31:44,673 - INFO - [Direct NCO] Processing math_scores_raw_value: 2686/3135 valid values (85.7%).
2025-10-18 19:31:44,674 - INFO - [Direct NCO] math_scores_raw_value with MO1+MO2: 2686 counties after dropna
2025-10-18 19:31:44,691 - INFO - [Direct NCO] Processing non_hispanic_black_raw_value: 3128/3135 valid values (99.8%).
2025-10-18 19:31:44,692 - INFO - [Direct NCO] non_hispanic_black_raw_value with MO1+MO2: 3128 counties after dropna
2025-10-18 19:31:44,712 - INFO - [Direct NCO] Processing non_hispanic_white_raw_value: 3135/3135 valid values (100.0%).
2025-10-18 19:31:44,713 - INFO - [Direct NCO] non_hispanic_white_raw_value with MO1+MO2: 3135 counties after dropna
2025-10-18 19:31:44,732 - INFO - [Direct NCO] Processing not_proficient_in_english_raw_value: 3135/3135 valid values (100.0%).
2025-10-18 19:31:44,733 - INFO - [Direct NCO] not_proficient_in_english_raw_value with MO1+MO2: 3135 counties after dropna
2025-10-18 19:31:44,752 - INFO - [Direct NCO] Processing reading_scores_raw_value: 2773/3135 valid values (88.5%).
2025-10-18 19:31:44,753 - INFO - [Direct NCO] reading_scores_raw_value with MO1+MO2: 2773 counties after dropna
2025-10-18 19:31:44,772 - INFO - [Direct NCO] Processing school_funding_adequacy_raw_value: 3051/3135 valid values (97.3%).
2025-10-18 19:31:44,773 - INFO - [Direct NCO] school_funding_adequacy_raw_value with MO1+MO2: 3051 counties after dropna
2025-10-18 19:31:44,792 - INFO - [Direct NCO] Processing school_segregation_raw_value: 2914/3135 valid values (93.0%).
2025-10-18 19:31:44,792 - INFO - [Direct NCO] school_segregation_raw_value with MO1+MO2: 2914 counties after dropna
2025-10-18 19:31:44,811 - INFO - [Direct NCO] Processing severe_housing_cost_burden_raw_value: 3130/3135 valid values (99.8%).
2025-10-18 19:31:44,811 - INFO - [Direct NCO] severe_housing_cost_burden_raw_value with MO1+MO2: 3130 counties after dropna
2025-10-18 19:31:44,831 - INFO - [Direct NCO] Processing traffic_volume_raw_value: 3104/3135 valid values (99.0%).
2025-10-18 19:31:44,832 - INFO - [Direct NCO] traffic_volume_raw_value with MO1+MO2: 3104 counties after dropna
2025-10-18 19:31:44,852 - INFO - [Direct NCO] Processing voter_turnout_raw_value: 3104/3135 valid values (99.0%).
2025-10-18 19:31:44,853 - INFO - [Direct NCO] voter_turnout_raw_value with MO1+MO2: 3104 counties after dropna
2025-10-18 19:31:44,880 - INFO - Wrote direct NCO results (154 rows).
2025-10-18 19:31:44,882 - INFO - [Placebo IV] Processing voter_turnout_raw_value: 3104 valid values.
2025-10-18 19:31:44,931 - INFO - [Placebo IV] Processing census_participation_raw_value: 3132 valid values.
2025-10-18 19:31:44,976 - INFO - [Placebo IV] Processing traffic_volume_raw_value: 3104 valid values.
2025-10-18 19:31:45,021 - INFO - [Placebo IV] Processing driving_alone_to_work_raw_value: 3135 valid values.
2025-10-18 19:31:45,066 - INFO - [Placebo IV] Processing long_commute_driving_alone_raw_value: 3135 valid values.
2025-10-18 19:31:45,112 - INFO - [Placebo IV] Processing reading_scores_raw_value: 2773 valid values.
2025-10-18 19:31:45,155 - INFO - [Placebo IV] Processing math_scores_raw_value: 2686 valid values.
2025-10-18 19:31:45,196 - INFO - [Placebo IV] Processing school_funding_adequacy_raw_value: 3051 valid values.
2025-10-18 19:31:45,242 - INFO - [Placebo IV] Processing school_segregation_raw_value: 2914 valid values.
2025-10-18 19:31:45,285 - INFO - [Placebo IV] Processing gender_pay_gap_raw_value: 3129 valid values.
2025-10-18 19:31:45,332 - INFO - Wrote placebo interactions (replace IV3) (140 rows).
2025-10-18 19:31:45,503 - INFO - Wrote placebo outcomes (keep IV3×MO) (49 rows).
2025-10-18 19:31:45,503 - INFO - DV21 long data shape: (2886, 5)
2025-10-18 19:31:45,503 - INFO - DV21 unique years available: [2024]
2025-10-18 19:31:45,503 - WARNING - No years in range 2010-2022 found for temporal falsification.
2025-10-18 19:31:45,503 - WARNING - Available years: [2024]
2025-10-18 19:31:45,503 - WARNING - Temporal falsification requires historical CHR data. Skipping this test.
2025-10-18 19:31:57,952 - INFO - Permutation tests done for MO1 family.
2025-10-18 19:31:58,012 - INFO - Guardrail checks written.
2025-10-18 19:31:58,015 - INFO - Precision-of-null summary saved.
2025-10-18 19:31:58,018 - INFO - ============================================================
2025-10-18 19:31:58,018 - INFO - NEGATIVE CONTROLS TEST SUITE COMPLETE
2025-10-18 19:31:58,018 - INFO - ============================================================
2025-10-18 19:31:58,018 - INFO - Output directory: ./negative_controls_output
2025-10-18 19:31:58,018 - INFO - Tests completed:
2025-10-18 19:31:58,018 - INFO -   ✓ Direct NCO tests: 154 results
2025-10-18 19:31:58,018 - INFO -   ✓ Placebo interactions: 140 results
2025-10-18 19:31:58,018 - INFO -   ✓ Placebo outcomes: 49 results
2025-10-18 19:31:58,018 - INFO -   ⚠ Temporal falsification: 0 results
2025-10-18 19:31:58,018 - INFO -   ✓ Permutation tests: 6 results
2025-10-18 19:31:58,018 - INFO -   ✓ Guardrail checks: 7 results
2025-10-18 19:31:58,018 - INFO - ============================================================
